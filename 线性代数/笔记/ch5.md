# 第五章

| Editor      | Time    |
| ----------- | ------- |
| frostwing98 | 2017.12 |
|             |         |



[TOC]



## 5.1（1） 二次型及标准型

#### 5.1.1 定义

平面二次曲线方程可以表示为一个列向量、一个矩阵和一个行向量的乘积。列向量就是$x_1,x_2,...,x_n$，而行向量就是转置。

这样表示因为原来的式子中$x_i*x_j;i\neq j	$是对称的，所以二次型矩阵一定是对称的。一般把这样的式子系数除以二放入矩阵对应的地方。

**实二次型**：不解释了

**二次型矩阵**：$f(x_1,x_2...x_n)=x^TAx$

**Definition 5.1.2**

我们称二次型

$$f(x_1,x_2,...,x_n)=x^TAx$$

中的对称矩阵A为二次型f的矩阵，A的秩称为二次型f的秩。


#### 5.1.2 二次型的标准型

1.对二次型

$ f(x,y,z)=x^2-2xy+8xz+y^2+8yz+4z^2= \begin{pmatrix} x & y & z \end{pmatrix} \begin{pmatrix} 1 & -1 & 4 \\\ -1 & 1 & 4 \\\ 4 & 4 & 4  \end{pmatrix} \begin{pmatrix} x \\\ y \\\ z \end{pmatrix} $


作变换

$$ \begin{equation} \begin{cases} x= \frac{1}{\sqrt6} x^\`+ \frac{1}{\sqrt2}y^\`+\frac{1}{\sqrt3}z^\`,\\\y=\frac{1}{\sqrt6}x^\`- \frac{1}{\sqrt2}y^\`+\frac{1}{\sqrt3}z^\`,\\\z=\frac{2}{\sqrt6}x^\`-\frac{1}{\sqrt3}z^\`,\end{cases} \end{equation}$$

有：

$$f(x,y,z)=\begin{pmatrix}x^\`&y^\`&z^\`\end{pmatrix}\begin{pmatrix}8&0&0\\\0&2&0\\\0&0&-4\end{pmatrix}\begin{pmatrix}x^\`\\\y^\`\\\z^\`\end{pmatrix},即f(x^{'},y^{'},z^{'})=8x^{'2}+2y^{'2}-4z^{'2}$$



那么我们就通过简单的变换，把原来的二次型简化为只有平方项的简单二次型，也就是**二次型的标准型**。

我们可以用矩阵表示这种变换：

$$f(x,y,z)= \begin{pmatrix}x^\`&y^\`&z^\` \end{pmatrix}P^T \begin{pmatrix}1&-1&4\\\ -1&1&4\\\4&4&4 \end{pmatrix}P \begin{pmatrix}x^\`\\\  y^\`\\\ z^\` \end{pmatrix},其中P= \begin{pmatrix}\frac{1}{\sqrt6}&\frac{1}{\sqrt2}&\frac{1}{\sqrt3}\\\ \frac{1}{\sqrt6}&-\frac{1}{\sqrt2}&\frac{1}{\sqrt3}\\\frac{2}{\sqrt6}&0&-\frac{1}{\sqrt3} \end{pmatrix}, \begin{pmatrix}x\\ y\\ z \end{pmatrix}=P \begin{pmatrix}x^\`\\\ y^\`\\\ z^\` \end{pmatrix}$$

2.同一个二次型可以有不同的标准型变换，比如上式的P也可以用$Q=\begin{pmatrix}1&-3&-7\\\ 0&1&1\\\ 0&1&2\end{pmatrix}$进行变换，

从而可以简化为一个新的标准型：$h(x^{''},y^{''},z^{''})=x^{''2}+4y^{''2}-16z^{''2}$

所以二次型有很多种不同的标准型。

> 其实就是一个换元的操作，只不过包上了线性代数矩阵的外壳。

**Definition 5.1.3 线性变换，非退化线性变换**

称如下变换为由$x_1,x_2...,x_n$到$y_1,y_2,...,y_n$的一个线性变换。

$\begin{pmatrix}x_1\\\ x_2\\\ ...\\\ x_n\end{pmatrix}=\begin{pmatrix}c_{11}&c_{12}...&...c_{nn}\\\ c_{21}&c_{22}...&...c_{2n}\\\ ...&......&......\\\ c_{n1}&c_{n2}...&...c_{nn}\end{pmatrix}\begin{pmatrix}y_1\\\ y_2\\\ ...\\\ y_n\end{pmatrix}$

若线性变换的系数行列式，$\vert P\vert \neq0$那么这就是非退化线性变换～

若$\vert P\vert =0$那么这就是退化线性变换～

如果P是正交矩阵，那么这就是正交变换～



**Definition 5.1.4合同变换**

设A和B是两个同阶的**方阵**，如果存在**可逆**矩阵P使得$B=P^TAP$则称A合同于B，B是A的合同矩阵，P是A到B的合同变换矩阵。

>这里我要说一下，之前和邵荣老师聊到过这个问题，合同的本质到底是什么。其实应该这么理解，合同本质上就是一个等价关系，离散数学中讲了，等价关系满足自反、对称、传递三个特性，仔细思考一下这是满足这三个特性的。
>
>第二点要说的是，合同变换其实和相似变换是可以互相类比的。相似变换$B=P^{-1}AP$是基于矩阵的逆的操作，合同变换$B=P^TAP$是基于矩阵转置的操作。相应的它们各自有一个特殊的值来表征这个性质。对于相似变换来说，这个值是特征值。而对于合同变换来说，这个值是惯性系数。这个之后会提到。

#### 5.1.3 二次型的简化方法

前面说到，如果二次型在非退化线性变换之后只得到纯平方项的二次型的话，那么我们就叫这个是原来二次型的标准形。~~说不记得了的回去面壁思过！~~

**0x01定义法**

**定理5.1.1 **

**将实二次型化为标准形的非退化线性变换存在，且平方项系数（对角矩阵的对角值）可以任意排列。**

**将实对称矩阵合同变换为实对角矩阵的可逆矩阵存在，且对角元素可任意次序排列。**

> 之所以我要把这个分为两句，是为了大家能更好的看出这两句话的对应关系。线性代数最大的一个特性就是方程组、矩阵、向量三位一体,本质上都是一样的。这，便是一个例证。
>
> 要注意几个点。第一，非退化，意味着前后等价，对于矩阵意味着可逆。第二，对角矩阵，意味着特征值。
>
> 所以不要死记硬背过程，记住这句话：我们的最终目标是获取特征值将矩阵对角化，只不过要是合同变换罢了。

这就是我们简化二次型的基石。

> 本来原则上我并不准备在这一单纯的知识点整理笔记里面浪费版面附例题的，但是这种题目的套路实在是太固定、太繁琐、也太基础了，所以我附上一个指南，大家看看就好。（其实这句说明就挺费版面了




> 例题5.1.4用正交变换将实二次型$f(x_1,x_2,x_3)=2x_1x_2+2x_1x_3-2x_2x_3$化为标准型，并给出相应的线性变换。
>
> 解：
>
> 1.化出实二次型的矩阵
>
> $$f(x)=x^TAx,A=\begin{pmatrix}0&1&1\\\ 1&0&1\\\ 1&-1&0\end{pmatrix}$$
>
> 2.求A的特征值：
>
> $$\vert \lambda E-A \vert=\left|\begin{array}\lambda-1&1&-4\\\ 1&\lambda-1&-4\\\ -4&-4&\lambda+4\end{array}\right|=(\lambda-2)(\lambda-4)(\lambda+8)=0$$
>
> 得特征值为$\lambda=1(二重),-2$.
>
> 3.求出特征向量，若单重，单位化，若多重，正交化。
>
> 对$\lambda=1:有相互正交的单位向量\eta_1=\sqrt2^{-1}(1,1,0)^T，\eta_2=\sqrt6^{-1}(1,-1,2)^T$
>
> 对$\lambda=-2:单位特征向量\eta_3=\sqrt3^{-1}(-1,1,1)^T$
>
> 4.组合特征向量为新矩阵，对应对角矩阵的对应位置是对应的特征向量：
>
> $P=(\eta_1,\eta_2,\eta_3)=\begin{pmatrix}\frac{1}{\sqrt2}&\frac{1}{\sqrt6}&\frac{1}{\sqrt3}\\\ \frac{1}{\sqrt2}&-\frac{1}{\sqrt6}&\frac{1}{\sqrt3}\\\ 0&\frac{2}{\sqrt6}&\frac{1}{\sqrt3}\end{pmatrix}$
>
> 有$P^TP=E,P^TAP=diag(1,1,-2)$
>
> 因此对应的标准型为
>
> $g(y_1,y_2,y_3)=y_1^2+y_2^2-2y_3^2.$

**0x02配方法**

就是把式子配成全平方项，如：

$f(x_1,x_2,x_3)=x_1^2-2x_1x_2+8x_1x_3+x_2^2+8x_2x_3-4x_3^2\\\ =(x_1-x_2+4x_3)^2+16x_2x_3-20x_3^2\\\ =(x_1-x_2+4x_3)^2-20(x_3-0.4x_2)^2+3.2x_2^2$

**0x03合同变换法**

原理：对$B=\begin{pmatrix}A\\\ E\end{pmatrix}$进行初等列变换，从而变成$\begin{pmatrix}\Lambda\\\ P\end{pmatrix}=\begin{pmatrix}P^T& \\\   &E\end{pmatrix}\begin{pmatrix}A\\\ E\end{pmatrix}P=\begin{pmatrix}P^TAP\\\ P\end{pmatrix}$

也就是用之前化矩阵的方式把$\begin{pmatrix}A\\\ E\end{pmatrix}$变成$\begin{pmatrix}\Lambda\\\ P\end{pmatrix}$

比如：

$$f(x_1,x_2,x_3)=x_1^2-2x_1x_2+8x_1x_3+x_2^2+8x_2x_3-4x_3^2$$

矩阵形式：

$$f(x)=x^TAx,A=\begin{pmatrix}1&-1&4\\\ -1&1&4\\\ 4&4&-4\end{pmatrix},x=\begin{pmatrix}x_1\\\ x_2\\\ x_3\end{pmatrix}$$

化为

$$\begin{pmatrix}1&-1&4\\\ -1&1&4\\\ 4&4&-4\\\  & & \\\ 1&0&0\\\ 0&1&0\\\ 0&0&1\end{pmatrix}\Rightarrow\begin{pmatrix}1&0&0\\\ 0&-4&0\\\ 0&0&16\\\  & & \\\ 1&-3&5\\\ 0&1&-3\\\ 0&1&-2\end{pmatrix}$$

$$\begin{equation}\begin{cases}x_1=y_1-3y_2+5y_3\\\ x_2=y_2-3y_3\\\ x_3=y_2-2y_3\end{cases}\end{equation}$$

$$g(y_1,y_2,y_3)=y_1^2-4y_2^2+16y_3^2$$



## 5.1（2）二次型的规范形 

规范形——标准形中最简单且唯一的形式。

**Definition5.1.6 实、复二次型的规范形**

经过非退化实线性变换得到如下形式：

$$\sum^r_{i=1}\pm z_i^2(r\leq n)$$

这就是实规范形。

如果是复，那么可以进一步化为：

$$\sum^r_{i=1}z_i^2(r\leq n)$$

这就是二次型的规范形，r就是二次型的秩。



> 规范形是恒存在的，篇幅有限不介绍了：要是这玩意都不一定存在我要这定理有何用～～～何用～～～用～～～



**重要定理：惯性定理**

存在非退化实线性变换将实二次型化为规范形$z_1^2+...+z_p^2-z_{p+1}^2...-z_r^2;$

存在实可逆矩阵把实对称矩阵合同变换为$diag(E_p,-E_{r-p},O_{n-r})$,其中：r为二次型矩阵的秩，p是确定的。

> 有了这个我们能干什么呢？这就有下面的惯性系数了：还记得之前我们提到的惯性指数吗？

**Definition 5.1.7正、负惯性指数**

对$z_1^2+...+z_p^2-z_{p+1}^2...-z_r^2;$

p为原二次型的正惯性指数，r-p是负惯性指数。

> 它的意义在于，正惯性指数=对角元正数的个数，负的也一样。加起来，r就是非零对角元的个数。这个，与特征值相对应，可以作为对称矩阵的表征数。



> 求正负惯性指数的过程很简单，就是想办法得到变换之后的对角矩阵，数数就是了。
>
> 当然也有更加简单的办法：求二次型系数矩阵，把特征值求出来，不就相当于化对角矩阵了么？直接数正、负特征值的个数。



## 5.2 正定二次型

化为标准型之后，如果当所有的变量不全为0时，函数大于0，那么就是正定二次型。

对应的系数/对角矩阵就是正定矩阵。

正定矩阵的正惯性系数就是阶数。（废话啦～只有全正在才能恒大于0不是么）

> $f(x)=x^TAx,当x \neq \theta时（变量不全为 0）：$
>
> ​	f(x)<0:负定二次型，A：负定矩阵
>
> ​	f(x)>0:正定二次型，A：正定矩阵
>
> ​	f(x)<=0:半负定二次型，A：半负定矩阵
>
> ​	f(x)>=0:半正定二次型，A：半正定矩阵



如何判断正定矩阵：

对于n阶实对称矩阵：

1. A的特征值均正
2. A的正惯性指数为n
3. A的各项顺序主子式为正（左上角i行i列构成的行列式，也就是这个子式没有发生行列的交换）

半正定：

1. A的特征值大于等于0
2. 正惯性指数为r(A)
3. A的各阶主子式非负





EOF.

$frostwing98,Feb~~14,2017$


